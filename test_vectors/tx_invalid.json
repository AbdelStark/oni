[
  ["Comments describing invalid transaction test vectors"],
  ["Format: [[prevouts], serialized_tx, flags]"],
  ["Each prevout: [txid, vout, scriptPubKey, amount?]"],
  ["These transactions MUST fail validation"],
  [""],

  ["No inputs"],
  [
    [],
    "010000000001000000000000000019001976a91489abcdefabbaabbaabbaabbaabbaabbaabbaabba88ac00000000",
    "P2SH"
  ],

  ["No outputs"],
  [
    [
      ["0000000000000000000000000000000000000000000000000000000000000001", 0, "0x76 0xa9 0x14 0x751e76e8199196d454941c45d1b3a323f1433bd6 0x88 0xac", 5000000000]
    ],
    "0100000001010000000000000000000000000000000000000000000000000000000000000000000000494830450221008b9d1dc26ba6a9cb62127b02742fa9d754cd3bebf337f7a55d114c8e5cdd30be022040529b194ba3f9281a99f2b1c0a19c0489bc22ede944ccf4ecbab4cc618ef3ed01ffffffff0000000000",
    "P2SH"
  ],

  ["Duplicate inputs (same outpoint twice)"],
  [
    [
      ["0000000000000000000000000000000000000000000000000000000000000001", 0, "0x76 0xa9 0x14 0x751e76e8199196d454941c45d1b3a323f1433bd6 0x88 0xac", 5000000000]
    ],
    "0100000002010000000000000000000000000000000000000000000000000000000000000000000000494830450221008b9d1dc26ba6a9cb62127b02742fa9d754cd3bebf337f7a55d114c8e5cdd30be022040529b194ba3f9281a99f2b1c0a19c0489bc22ede944ccf4ecbab4cc618ef3ed01ffffffff010000000000000000000000000000000000000000000000000000000000000000000000494830450221008b9d1dc26ba6a9cb62127b02742fa9d754cd3bebf337f7a55d114c8e5cdd30be022040529b194ba3f9281a99f2b1c0a19c0489bc22ede944ccf4ecbab4cc618ef3ed01ffffffff0100ca9a3b00000000160014751e76e8199196d454941c45d1b3a323f1433bd600000000",
    "P2SH"
  ],

  ["Negative output value"],
  [
    [
      ["0000000000000000000000000000000000000000000000000000000000000001", 0, "0x76 0xa9 0x14 0x751e76e8199196d454941c45d1b3a323f1433bd6 0x88 0xac", 5000000000]
    ],
    "0100000001010000000000000000000000000000000000000000000000000000000000000000000000494830450221008b9d1dc26ba6a9cb62127b02742fa9d754cd3bebf337f7a55d114c8e5cdd30be022040529b194ba3f9281a99f2b1c0a19c0489bc22ede944ccf4ecbab4cc618ef3ed01ffffffff01ffffffffffffffff160014751e76e8199196d454941c45d1b3a323f1433bd600000000",
    "P2SH"
  ],

  ["Output value exceeds max money"],
  [
    [
      ["0000000000000000000000000000000000000000000000000000000000000001", 0, "0x76 0xa9 0x14 0x751e76e8199196d454941c45d1b3a323f1433bd6 0x88 0xac", 5000000000]
    ],
    "0100000001010000000000000000000000000000000000000000000000000000000000000000000000494830450221008b9d1dc26ba6a9cb62127b02742fa9d754cd3bebf337f7a55d114c8e5cdd30be022040529b194ba3f9281a99f2b1c0a19c0489bc22ede944ccf4ecbab4cc618ef3ed01ffffffff010040e59c30120200160014751e76e8199196d454941c45d1b3a323f1433bd600000000",
    "P2SH"
  ],

  ["Sum of outputs exceeds max money"],
  [
    [
      ["0000000000000000000000000000000000000000000000000000000000000001", 0, "0x76 0xa9 0x14 0x751e76e8199196d454941c45d1b3a323f1433bd6 0x88 0xac", 21000001 * 100000000]
    ],
    "0100000001010000000000000000000000000000000000000000000000000000000000000000000000494830450221008b9d1dc26ba6a9cb62127b02742fa9d754cd3bebf337f7a55d114c8e5cdd30be022040529b194ba3f9281a99f2b1c0a19c0489bc22ede944ccf4ecbab4cc618ef3ed01ffffffff020020bcbe19230100160014751e76e8199196d454941c45d1b3a323f1433bd60020bcbe19230100160014751e76e8199196d454941c45d1b3a323f1433bd600000000",
    "P2SH"
  ],

  ["Spending non-existent input"],
  [
    [],
    "0100000001010000000000000000000000000000000000000000000000000000000000000000000000494830450221008b9d1dc26ba6a9cb62127b02742fa9d754cd3bebf337f7a55d114c8e5cdd30be022040529b194ba3f9281a99f2b1c0a19c0489bc22ede944ccf4ecbab4cc618ef3ed01ffffffff0100f2052a0100000019001976a91489abcdefabbaabbaabbaabbaabbaabbaabbaabba88ac00000000",
    "P2SH"
  ],

  ["Invalid signature (wrong pubkey)"],
  [
    [
      ["0000000000000000000000000000000000000000000000000000000000000001", 0, "0x76 0xa9 0x14 0x751e76e8199196d454941c45d1b3a323f1433bd6 0x88 0xac", 5000000000]
    ],
    "0100000001010000000000000000000000000000000000000000000000000000000000000000000000494830450221000000000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000000000121030000000000000000000000000000000000000000000000000000000000000000ffffffff0100f2052a0100000019001976a91489abcdefabbaabbaabbaabbaabbaabbaabbaabba88ac00000000",
    "P2SH"
  ],

  ["CLTV failure - locktime not reached"],
  [
    [
      ["0000000000000000000000000000000000000000000000000000000000000006", 0, "0x04 0x00 0x00 0x00 0x60 OP_CHECKLOCKTIMEVERIFY OP_DROP 0x76 0xa9 0x14 0x751e76e8199196d454941c45d1b3a323f1433bd6 0x88 0xac", 25000000]
    ],
    "01000000010600000000000000000000000000000000000000000000000000000000000000000000004948304502210091d1c426ba6a9cb62127b02742fa9d754cd3bebf337f7a55d114c8e5cdd30be0022040529b194ba3f9281a99f2b1c0a19c0489bc22ede944ccf4ecbab4cc618ef3ed0100000050010065cd1d00000000160014751e76e8199196d454941c45d1b3a323f1433bd600000000",
    "P2SH,CHECKLOCKTIMEVERIFY"
  ],

  ["Witness program version 0 with wrong witness size"],
  [
    [
      ["0000000000000000000000000000000000000000000000000000000000000003", 0, "0x00 0x14 0x751e76e8199196d454941c45d1b3a323f1433bd6", 100000000]
    ],
    "01000000000101030000000000000000000000000000000000000000000000000000000000000000000000000000000001605af40500000000160014751e76e8199196d454941c45d1b3a323f1433bd601210279be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f8179800000000",
    "P2SH,WITNESS"
  ],

  ["P2SH script hash mismatch"],
  [
    [
      ["0000000000000000000000000000000000000000000000000000000000000002", 0, "0xa9 0x14 0x89abcdefabbaabbaabbaabbaabbaabbaabbaabba 0x87", 1000000000]
    ],
    "0100000001020000000000000000000000000000000000000000000000000000000000000000000000232200200000000000000000000000000000000000000000000000000000000000000000ffffffff0100ca9a3b00000000160014751e76e8199196d454941c45d1b3a323f1433bd600000000",
    "P2SH"
  ],

  ["Oversized scriptSig (>10000 bytes)"],
  [
    [
      ["0000000000000000000000000000000000000000000000000000000000000001", 0, "0x76 0xa9 0x14 0x751e76e8199196d454941c45d1b3a323f1433bd6 0x88 0xac", 5000000000]
    ],
    "0100000001010000000000000000000000000000000000000000000000000000000000000000000000fd1127000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffff0100f2052a0100000019001976a91489abcdefabbaabbaabbaabbaabbaabbaabbaabba88ac00000000",
    "P2SH"
  ],

  ["Outputs sum exceeds inputs (no coinbase)"],
  [
    [
      ["0000000000000000000000000000000000000000000000000000000000000001", 0, "0x76 0xa9 0x14 0x751e76e8199196d454941c45d1b3a323f1433bd6 0x88 0xac", 1000000]
    ],
    "0100000001010000000000000000000000000000000000000000000000000000000000000000000000494830450221008b9d1dc26ba6a9cb62127b02742fa9d754cd3bebf337f7a55d114c8e5cdd30be022040529b194ba3f9281a99f2b1c0a19c0489bc22ede944ccf4ecbab4cc618ef3ed01ffffffff0100e1f505000000001600149abcdefabbaabbaabbaabbaabbaabbaabbaabba000000000",
    "P2SH"
  ],

  ["Empty scriptPubKey with non-empty scriptSig fails for witness v0"],
  [
    [
      ["0000000000000000000000000000000000000000000000000000000000000001", 0, "0x00 0x14 0x751e76e8199196d454941c45d1b3a323f1433bd6", 5000000000]
    ],
    "0100000001010000000000000000000000000000000000000000000000000000000000000000000000050100000000ffffffff0100f2052a0100000019001976a91489abcdefabbaabbaabbaabbaabbaabbaabbaabba88ac00000000",
    "P2SH,WITNESS"
  ],

  ["Schnorr signature in non-Taproot witness v0"],
  [
    [
      ["0000000000000000000000000000000000000000000000000000000000000003", 0, "0x00 0x14 0x751e76e8199196d454941c45d1b3a323f1433bd6", 100000000]
    ],
    "01000000000101030000000000000000000000000000000000000000000000000000000000000000000000000000000001605af40500000000160014751e76e8199196d454941c45d1b3a323f1433bd60240a1b2c3d4e5f6a7b8c9d0e1f2a3b4c5d6e7f8091a2b3c4d5e6f7a8b9c0d1e2f3a4b5c6d7e8f9a0b1c2d3e4f5a6b7c8d9e0f1a2b3c4d5e6f7a8b9c0d1e2f3a4b50121024f355bdcb7cc0af728ef3cceb9615d90684bb5b2ca5f859ab0f0b704075871aa00000000",
    "P2SH,WITNESS"
  ]
]
